/* 任务样式 */
@layer components {
  .task-grid {
    @apply grid gap-4;
    grid-template-columns: repeat(auto-fit, minmax(280px, 360px));
    justify-content: flex-start;
  }

  .task-item {
    @apply relative flex flex-col justify-between gap-4 rounded-3xl border border-slate-200/60 bg-white/90 px-5 py-5 transition-all duration-200 max-w-[360px] min-h-[240px];
    box-shadow: 0 22px 45px -38px rgba(30, 64, 175, 0.25);
  }

  .task-item:hover {
    transform: translateY(-3px);
    box-shadow: 0 32px 60px -34px rgba(30, 64, 175, 0.32);
  }

  .task-item--disabled {
    @apply opacity-70;
  }

  .task-item__header {
    @apply flex items-start justify-between gap-3;
    min-height: 48px;
  }

  .task-item__primary {
    @apply flex items-start gap-3 min-w-0 flex-1;
  }

  .task-item__text {
    @apply flex-1 min-w-0;
  }

  .task-item__title {
    @apply text-base font-semibold text-slate-900;
  }

  .task-item__desc {
    @apply text-sm text-slate-500 mt-1;
    white-space: nowrap;
  }

  .task-item__meta {
    @apply flex items-center gap-2 flex-shrink-0;
    align-self: flex-start;
    padding-top: 0;
    margin-top: -5px;
  }

  .task-item__actions {
    @apply flex items-center gap-1;
    opacity: 0;
    transition: opacity 0.2s ease;
  }

  .task-item:hover .task-item__actions,
  .task-item:focus-within .task-item__actions {
    opacity: 1;
  }

  @media (max-width: 1023px) {
    .task-item__actions {
      opacity: 1;
    }
    
    /* 移动端显示拖拽手柄 */
    .drag-handle {
      opacity: 0.3;
    }
    
    .task-item:hover .drag-handle {
      opacity: 0.6;
    }
  }

  /* 时间线样式 */
  .task-item__timeline {
    @apply relative flex items-stretch gap-4;
  }

  .task-timeline__bar {
    @apply absolute left-3 top-1 bottom-1 w-0.5 bg-gradient-to-b from-blue-200 via-blue-100 to-transparent rounded-full;
  }

  .task-timeline__content {
    @apply flex-1 space-y-2 pl-6 text-sm;
  }

  .task-timeline__row {
    @apply relative grid items-center gap-3 bg-slate-50/70 border border-slate-200 rounded-2xl px-4 py-2;
    grid-template-columns: 48px 1fr;
  }

  .task-timeline__row--accent {
    @apply bg-blue-50/80 border-blue-100;
  }

  .task-timeline__dot {
    @apply absolute left-[-24px] w-3 h-3 rounded-full bg-white border border-blue-300 shadow;
  }

  .task-timeline__row--accent .task-timeline__dot {
    @apply bg-blue-500 border-blue-500 shadow-lg;
  }

  .task-timeline__row--success .task-timeline__dot {
    @apply bg-green-500 border-green-500;
  }

  .task-timeline__row--error .task-timeline__dot {
    @apply bg-red-500 border-red-500;
  }

  .task-timeline__label {
    @apply text-xs font-semibold text-slate-400 uppercase tracking-wider text-right;
  }

  .task-timeline__value {
    @apply text-sm font-medium text-slate-700 leading-relaxed;
  }

  .task-item--disabled .task-timeline__row {
    @apply opacity-70;
  }

  /* 拖拽相关样式 */
  .task-item {
    user-select: none;
    transition: all 0.2s ease;
  }

  .drag-handle {
    opacity: 0;
    transition: opacity 0.2s ease;
  }

  .task-item:hover .drag-handle {
    opacity: 0.4;
  }

  .task-item:hover .drag-handle:hover {
    opacity: 0.8;
  }

  .task-item--dragging {
    @apply opacity-50 rotate-2 scale-105;
    z-index: 1000;
    pointer-events: none;
  }

  .task-item--drag-over {
    @apply border-blue-400 bg-blue-50/50;
    transform: translateY(-3px) scale(1.02);
  }

  .task-grid {
    position: relative;
  }

  .drag-placeholder {
    @apply border-2 border-dashed border-blue-300 bg-blue-50/30 rounded-3xl;
    min-height: 240px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #64748b;
    font-size: 14px;
    transition: all 0.2s ease;
  }

  .drag-placeholder::before {
    content: "拖放到此处";
  }
}