/* ä»»åŠ¡æ ·å¼ */
@layer components {
  .task-grid {
    @apply grid gap-4;
    grid-template-columns: repeat(auto-fit, minmax(280px, 360px));
    justify-content: flex-start;
  }

  .task-item {
    @apply relative flex flex-col justify-between gap-4 rounded-3xl border border-slate-200/60 bg-white/90 px-5 py-5 transition-all duration-200 max-w-[360px] min-h-[240px];
    box-shadow: 0 22px 45px -38px rgba(30, 64, 175, 0.25);
  }

  .task-item:hover {
    transform: translateY(-3px);
    box-shadow: 0 32px 60px -34px rgba(30, 64, 175, 0.32);
  }

  .task-item--disabled {
    @apply opacity-70;
  }

  .task-item__header {
    @apply flex items-start justify-between gap-3;
    min-height: 48px;
  }

  .task-item__primary {
    @apply flex items-start gap-3 min-w-0 flex-1;
  }

  .task-item__text {
    @apply flex-1 min-w-0;
  }

  .task-item__title {
    @apply text-base font-semibold text-slate-900;
  }

  .task-item__desc {
    @apply text-sm text-slate-500 mt-1;
    white-space: nowrap;
  }

  .task-item__meta {
    @apply flex items-center gap-2 flex-shrink-0;
    align-self: flex-start;
    padding-top: 0;
    margin-top: -5px;
  }

  .task-item__actions {
    @apply flex items-center gap-1;
    opacity: 0;
    transition: opacity 0.2s ease;
  }

  .task-item:hover .task-item__actions,
  .task-item:focus-within .task-item__actions {
    opacity: 1;
  }

  @media (max-width: 1023px) {
    .task-item__actions {
      opacity: 1;
    }
    
    /* ç§»åŠ¨ç«¯æ˜¾ç¤ºæ‹–æ‹½æ‰‹æŸ„ */
    .drag-handle {
      opacity: 0.5;
      background-color: rgba(59, 130, 246, 0.1);
      transform: scale(1.1);
    }
    
    .task-item:hover .drag-handle,
    .drag-handle:active {
      opacity: 1;
      background-color: rgba(59, 130, 246, 0.2);
      transform: scale(1.2);
    }

    /* ç§»åŠ¨ç«¯æ‹–æ‹½æç¤ºæ›´æ˜æ˜¾ */
    .task-item--dragging {
      transform: rotate(8deg) scale(1.1);
      animation: mobile-drag-wobble 0.3s ease-in-out infinite alternate;
    }

    @keyframes mobile-drag-wobble {
      0% { transform: rotate(8deg) scale(1.1); }
      100% { transform: rotate(6deg) scale(1.08); }
    }
  }

  /* æ—¶é—´çº¿æ ·å¼ */
  .task-item__timeline {
    @apply relative flex items-stretch gap-4;
  }

  .task-timeline__bar {
    @apply absolute left-3 top-1 bottom-1 w-0.5 bg-gradient-to-b from-blue-200 via-blue-100 to-transparent rounded-full;
  }

  .task-timeline__content {
    @apply flex-1 space-y-2 pl-6 text-sm;
  }

  .task-timeline__row {
    @apply relative grid items-center gap-3 bg-slate-50/70 border border-slate-200 rounded-2xl px-4 py-2;
    grid-template-columns: 48px 1fr;
  }

  .task-timeline__row--accent {
    @apply bg-blue-50/80 border-blue-100;
  }

  .task-timeline__dot {
    @apply absolute left-[-24px] w-3 h-3 rounded-full bg-white border border-blue-300 shadow;
  }

  .task-timeline__row--accent .task-timeline__dot {
    @apply bg-blue-500 border-blue-500 shadow-lg;
  }

  .task-timeline__row--success .task-timeline__dot {
    @apply bg-green-500 border-green-500;
  }

  .task-timeline__row--error .task-timeline__dot {
    @apply bg-red-500 border-red-500;
  }

  .task-timeline__label {
    @apply text-xs font-semibold text-slate-400 uppercase tracking-wider text-right;
  }

  .task-timeline__value {
    @apply text-sm font-medium text-slate-700 leading-relaxed;
  }

  .task-item--disabled .task-timeline__row {
    @apply opacity-70;
  }

  /* æ‹–æ‹½ç›¸å…³æ ·å¼ */
  .task-item {
    user-select: none;
    transition: all 0.2s ease;
  }

  .drag-handle {
    opacity: 0;
    transition: all 0.3s ease;
    padding: 4px;
    border-radius: 6px;
    position: relative;
  }

  .task-item:hover .drag-handle {
    opacity: 0.6;
    background-color: rgba(59, 130, 246, 0.1);
    transform: scale(1.1);
  }

  .task-item:hover .drag-handle:hover {
    opacity: 1;
    background-color: rgba(59, 130, 246, 0.2);
    transform: scale(1.2);
    box-shadow: 0 2px 8px rgba(59, 130, 246, 0.3);
  }

  .drag-handle::after {
    content: '';
    position: absolute;
    top: -2px;
    left: -2px;
    right: -2px;
    bottom: -2px;
    border: 2px dashed transparent;
    border-radius: 8px;
    transition: all 0.2s ease;
  }

  .task-item:hover .drag-handle:hover::after {
    border-color: rgba(59, 130, 246, 0.4);
    animation: pulse-border 2s infinite;
  }

  /* æ‹–æ‹½æç¤ºæ°”æ³¡ */
  .drag-handle:hover .drag-tooltip {
    opacity: 1;
    animation: tooltip-show 0.3s ease-out;
  }

  @keyframes tooltip-show {
    0% {
      opacity: 0;
      transform: translate(-50%, -5px);
    }
    100% {
      opacity: 1;
      transform: translate(-50%, 0);
    }
  }

  @keyframes pulse-border {
    0%, 100% { 
      border-color: rgba(59, 130, 246, 0.4);
      transform: scale(1);
    }
    50% { 
      border-color: rgba(59, 130, 246, 0.7);
      transform: scale(1.05);
    }
  }

  .task-item--dragging {
    @apply opacity-60;
    z-index: 1000;
    pointer-events: none;
    transform: rotate(5deg) scale(1.08);
    box-shadow: 0 20px 40px rgba(59, 130, 246, 0.4);
    border: 2px solid rgba(59, 130, 246, 0.6);
    animation: drag-wobble 0.5s ease-in-out infinite alternate;
  }

  @keyframes drag-wobble {
    0% { transform: rotate(5deg) scale(1.08); }
    100% { transform: rotate(3deg) scale(1.06); }
  }

  .task-item--drag-over {
    @apply border-blue-400 bg-blue-50/70;
    transform: translateY(-5px) scale(1.03);
    box-shadow: 0 15px 30px rgba(59, 130, 246, 0.3);
    animation: drop-zone-pulse 1s ease-in-out infinite;
  }

  @keyframes drop-zone-pulse {
    0%, 100% { 
      background-color: rgba(219, 234, 254, 0.7);
      border-color: rgb(96, 165, 250);
    }
    50% { 
      background-color: rgba(147, 197, 253, 0.8);
      border-color: rgb(59, 130, 246);
    }
  }

  .task-grid {
    position: relative;
  }

  .drag-placeholder {
    @apply border-2 border-dashed border-blue-400 bg-blue-50/60 rounded-3xl;
    min-height: 240px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    color: #3b82f6;
    font-size: 16px;
    font-weight: 600;
    transition: all 0.3s ease;
    animation: placeholder-bounce 2s ease-in-out infinite;
    box-shadow: 0 8px 25px rgba(59, 130, 246, 0.2);
  }

  @keyframes placeholder-bounce {
    0%, 100% { 
      transform: translateY(0px);
      box-shadow: 0 8px 25px rgba(59, 130, 246, 0.2);
    }
    50% { 
      transform: translateY(-3px);
      box-shadow: 0 12px 30px rgba(59, 130, 246, 0.3);
    }
  }

  .drag-placeholder::before {
    content: "ğŸ“Œ æ‹–æ”¾åˆ°æ­¤å¤„";
    margin-bottom: 8px;
  }

  .drag-placeholder::after {
    content: "æ¾å¼€é¼ æ ‡å®Œæˆæ’åº";
    font-size: 12px;
    color: #64748b;
    font-weight: 400;
  }
}