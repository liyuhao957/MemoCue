<!-- 分类管理模态框 -->
<div x-show="activeModal === 'category'"
     x-cloak
     x-transition
     class="modal-backdrop">
  <div @click.away="closeModal()" @keydown.escape.window="closeModal()"
       x-transition
       class="modal-content category-modal__container">
    <div class="p-6 category-modal space-y-4">
      <div class="category-modal__header">
        <div>
          <p class="category-modal__status" x-text="editingCategory ? '更新现有分类' : '创建一个全新分类'"></p>
          <h2 class="category-modal__title" x-text="editingCategory ? '编辑分类' : '新建分类'"></h2>
        </div>
        <div class="category-preview" :style="{'--preview-color': categoryForm.color || '#4F46E5'}">
          <div class="category-preview__icon">
            <span x-text="categoryForm.icon || '📁'"></span>
          </div>
          <div class="category-preview__text">
            <p class="category-preview__label">实时预览</p>
            <p class="category-preview__title" x-text="categoryForm.name || '未命名分类'"></p>
            <p class="category-preview__meta" x-text="(categoryForm.color || '#4F46E5').toUpperCase()"></p>
          </div>
        </div>
      </div>

      <form @submit.prevent="saveCategory" class="category-form space-y-3">
        <div class="form-field">
          <label class="label-modern">分类名称</label>
          <input type="text" x-model="categoryForm.name" required class="input-modern" placeholder="例如：工作、生活、学习">
        </div>

        <div class="category-form__row">
          <div class="category-form__icon-section">
            <label class="label-modern">图标</label>
            <div class="icon-input-group">
              <input type="text" x-model="categoryForm.icon" maxlength="2" placeholder="📁" class="input-modern input-icon">
              <div class="emoji-grid-compact">
                <template x-for="emoji in emojiPresets.slice(0,10)" :key="emoji">
                  <button type="button"
                          class="emoji-btn-compact"
                          :class="categoryForm.icon === emoji ? 'emoji-btn-compact--active' : ''"
                          @click="categoryForm.icon = emoji">
                    <span x-text="emoji"></span>
                  </button>
                </template>
              </div>
            </div>
          </div>

          <div class="category-form__color-section">
            <label class="label-modern">颜色</label>
            <div class="color-input-group">
              <input type="color" x-model="categoryForm.color" class="category-color-picker">
              <span class="color-badge" x-text="(categoryForm.color || '#4F46E5').toUpperCase()"></span>
            </div>
          </div>
        </div>

        <div class="category-modal__note">
          <div class="category-modal__note-icon">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m2-4h.01M12 20a8 8 0 100-16 8 8 0 000 16z"></path>
            </svg>
          </div>
          <p>统一的命名与配色可以让任务列表的数据更有层次，随时可以再次编辑来微调体验。</p>
        </div>

        <div class="category-modal__footer">
          <button type="button" @click="closeModal()" class="category-modal__btn category-modal__btn--ghost">取消</button>
          <button type="submit" class="category-modal__btn category-modal__btn--primary">保存</button>
        </div>
      </form>
    </div>
  </div>
</div>
